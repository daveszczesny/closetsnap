import{g as h,r as g,l as p,b as f,d as _,_ as m,o as y,c as S,e as t,t as r,f as v,F as b,p as w,h as B}from"./index-3459aeb0.js";import{l as x}from"./auth_signout-95852c4e.js";import{g as A}from"./db_read_user-9b547f39.js";async function u(o){const s=h();try{const e=g(s,o),c=await p(e);let a=0;for(const l of c.items){const n=await f(l);a+=n.size}for(const l of c.prefixes){const n=l.fullPath,d=await u(n);a+=d}return a}catch(e){return console.error("Error calculating bytes in folder: ",e),0}}const U={data(){return{auth:!1,email:null,name:null,totalBytesUsed:0,bytesToMb:1e6,allowedStorageSpace:512,percentageUsedSpace:0}},methods:{logout(){x()}},async mounted(){_().onAuthStateChanged(async o=>{if(o){this.auth=!0,console.log("Signed in"),this.email=o.email,A("name").then(e=>{this.name=e});const s="users/"+this.email;console.log(s),await u(s).then(e=>{if(e==null)return;console.log("Total Bytes used by user: ",e),this.totalBytesUsed=Math.round(e/this.bytesToMb),this.percentageUsedSpace=this.totalBytesUsed/this.allowedStorageSpace*100;const c=document.querySelector(".used-space");c.style.width=this.percentageUsedSpace+"%"})}else this.auth=!1,this.$router.push("/Login")})}};const i=o=>(w("data-v-c5663b54"),o=o(),B(),o),F={class:"account-heading"},I=i(()=>t("h1",null,"This is your account overview",-1)),M=i(()=>t("p",{style:{"margin-top":"2vh","margin-left":"2vh",color:"white","font-size":"large"}},"Storage allowance",-1)),T=i(()=>t("div",{class:"storage"},[t("div",{class:"storage-bar"},[t("div",{class:"used-space"})])],-1)),P={class:"storage-text"};function k(o,s,e,c,a,l){return y(),S(b,null,[t("div",F,[t("h1",null,"Hi "+r(a.name)+"!,",1),I]),M,T,t("div",P,[t("p",null,r(a.totalBytesUsed)+" / "+r(a.allowedStorageSpace)+" mb used",1)]),v(" Account overview section "),t("button",{class:"logout-button",onClick:s[0]||(s[0]=(...n)=>l.logout&&l.logout(...n))},"Log out")],64)}const V=m(U,[["render",k],["__scopeId","data-v-c5663b54"],["__file","/home/dave/Documents/VueFleet/vue-project/src/pages/Account.vue"]]);export{V as default};
